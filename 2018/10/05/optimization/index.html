<!-- build time:Fri Oct 05 2018 23:46:23 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta name="referrer" content="never"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>optimization | Amadeus</title><meta name="description" content="OptimizationOptimization is the process of finding the set of parameters W that minimize the loss function,å¦‚ä½•æ”¹å˜wä½¿å¾—æŸå¤±å‡½æ•°ä¸æ–­å‡å° Strategy #1 random searchæ ¸å¿ƒæ€æƒ³:ä¸€æ¬¡æ€§æ‰¾åˆ°ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°çš„wå–å€¼è²Œä¼¼å¾ˆéš¾ï¼Ÿ(random search,a bad ide"><meta name="keywords" content="notebook,image classification"><meta property="og:type" content="article"><meta property="og:title" content="optimization"><meta property="og:url" content="http://aier02.com/2018/10/05/optimization/index.html"><meta property="og:site_name" content="Aier02"><meta property="og:description" content="OptimizationOptimization is the process of finding the set of parameters W that minimize the loss function,å¦‚ä½•æ”¹å˜wä½¿å¾—æŸå¤±å‡½æ•°ä¸æ–­å‡å° Strategy #1 random searchæ ¸å¿ƒæ€æƒ³:ä¸€æ¬¡æ€§æ‰¾åˆ°ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°çš„wå–å€¼è²Œä¼¼å¾ˆéš¾ï¼Ÿ(random search,a bad ide"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="http://aier02.com/images/181005/dataflow.jpeg"><meta property="og:updated_time" content="2018-10-05T15:46:13.106Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="optimization"><meta name="twitter:description" content="OptimizationOptimization is the process of finding the set of parameters W that minimize the loss function,å¦‚ä½•æ”¹å˜wä½¿å¾—æŸå¤±å‡½æ•°ä¸æ–­å‡å° Strategy #1 random searchæ ¸å¿ƒæ€æƒ³:ä¸€æ¬¡æ€§æ‰¾åˆ°ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°çš„wå–å€¼è²Œä¼¼å¾ˆéš¾ï¼Ÿ(random search,a bad ide"><meta name="twitter:image" content="http://aier02.com/images/181005/dataflow.jpeg"><link rel="canonical" href="http://aier02.com/2018/10/05/optimization/index.html"><link rel="alternate" href="/atom.xml" title="Aier02" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link href="https://cdn.bootcss.com/KaTeX/0.7.1/katex.min.css" rel="stylesheet"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/aier02" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Amadeus</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">cvçˆ±å¥½è€…</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Guangdong, China</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="æœç´¢"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">é¦–é¡µ</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">å½’æ¡£</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">åˆ†ç±»</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">æ ‡ç­¾</span></a></li><li class="menu-item menu-item-repository"><a href="/repository"><i class="icon icon-project"></i> <span class="menu-title">é¡¹ç›®</span></a></li><li class="menu-item menu-item-books"><a href="/books"><i class="icon icon-book-fill"></i> <span class="menu-title">ä¹¦å•</span></a></li><li class="menu-item menu-item-links"><a href="/links"><i class="icon icon-friendship"></i> <span class="menu-title">å‹é“¾</span></a></li><li class="menu-item menu-item-about"><a href="/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">å…³äº</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/aier02" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">å…¬å‘Š</h3><div class="widget-body"><div id="board"><div class="content"><p>æ¬¢è¿äº¤æµä¸åˆ†äº«ç»éªŒ!</p></div></div></div></div><div class="widget"><h3 class="widget-title">åˆ†ç±»</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Kaggle/">Kaggle</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/cs231n/">cs231n</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/pytorch/">pytorch</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/statistical-learning-method/">statistical learning method</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">æ ‡ç­¾</h3><div class="widget-body"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CNN/">CNN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ChexNet/">ChexNet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EDA/">EDA</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Github-page/">Github page</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ResNet/">ResNet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SVM/">SVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basic-knowledge/">basic knowledge</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chest-X-ray/">chest X-ray</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/demo/">demo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/experience/">experience</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/image-classification/">image classification</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/introduction/">introduction</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jikecloud/">jikecloud</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keras/">keras</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linear-classification/">linear classification</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/namesilo/">namesilo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notebook/">notebook</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pytorch-cookbook/">pytorch cookbook</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/segmentation/">segmentation</a><span class="tag-list-count">3</span></li></ul></div></div><div class="widget"><h3 class="widget-title">æ ‡ç­¾äº‘</h3><div class="widget-body tagcloud"><a href="/tags/CNN/" style="font-size:13px">CNN</a> <a href="/tags/ChexNet/" style="font-size:13px">ChexNet</a> <a href="/tags/EDA/" style="font-size:13px">EDA</a> <a href="/tags/Github-page/" style="font-size:13px">Github page</a> <a href="/tags/Hexo/" style="font-size:13px">Hexo</a> <a href="/tags/ResNet/" style="font-size:13px">ResNet</a> <a href="/tags/SVM/" style="font-size:13px">SVM</a> <a href="/tags/basic-knowledge/" style="font-size:14px">basic knowledge</a> <a href="/tags/chest-X-ray/" style="font-size:13px">chest X-ray</a> <a href="/tags/demo/" style="font-size:13px">demo</a> <a href="/tags/experience/" style="font-size:13px">experience</a> <a href="/tags/image-classification/" style="font-size:13px">image classification</a> <a href="/tags/introduction/" style="font-size:13px">introduction</a> <a href="/tags/jikecloud/" style="font-size:13px">jikecloud</a> <a href="/tags/keras/" style="font-size:13px">keras</a> <a href="/tags/linear-classification/" style="font-size:13px">linear classification</a> <a href="/tags/namesilo/" style="font-size:13px">namesilo</a> <a href="/tags/notebook/" style="font-size:13.5px">notebook</a> <a href="/tags/pytorch-cookbook/" style="font-size:13px">pytorch cookbook</a> <a href="/tags/segmentation/" style="font-size:14px">segmentation</a></div></div><div class="widget"><h3 class="widget-title">å½’æ¡£</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">åæœˆ 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">ä¹æœˆ 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">å…«æœˆ 2018</a><span class="archive-list-count">2</span></li></ul></div></div><div class="widget"><h3 class="widget-title">æœ€æ–°æ–‡ç« </h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/cs231n/">cs231n</a></p><p class="item-title"><a href="/2018/10/05/optimization/" class="title">optimization</a></p><p class="item-date"><time datetime="2018-10-05T12:44:14.537Z" itemprop="datePublished">2018-10-05</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/cs231n/">cs231n</a></p><p class="item-title"><a href="/2018/10/03/linear_classification/" class="title">Linear classification</a></p><p class="item-date"><time datetime="2018-10-03T05:31:44.756Z" itemprop="datePublished">2018-10-03</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/pytorch/">pytorch</a></p><p class="item-title"><a href="/2018/10/02/pytorch_cookbook-U2&U3/" class="title">pytorch cookbook U2&amp;U3</a></p><p class="item-date"><time datetime="2018-10-02T08:27:32.398Z" itemprop="datePublished">2018-10-02</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Kaggle/">Kaggle</a></p><p class="item-title"><a href="/2018/10/02/rsna_summary/" class="title">first time in Kaggle-summary</a></p><p class="item-date"><time datetime="2018-10-01T16:08:39.573Z" itemprop="datePublished">2018-10-02</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/python/">python</a></p><p class="item-title"><a href="/2018/09/28/python_rubbish_collection/" class="title">python rubbish collection</a></p><p class="item-date"><time datetime="2018-09-28T07:32:02.260Z" itemprop="datePublished">2018-09-28</time></p></div></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">æ–‡ç« ç›®å½•</h3><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#optimization"><span class="toc-number">1.</span> <span class="toc-text">Optimization</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#strategy-1-random-search"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">Strategy #1 random search</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#strategy-2-random-local-search"><span class="toc-number">1.0.0.2.</span> <span class="toc-text">Strategy #2 random local search</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#strategy-3-follow-gradient"><span class="toc-number">1.0.0.3.</span> <span class="toc-text">Strategy #3 follow gradient</span></a></li></ol></li></ol><li class="toc-item toc-level-1"><a class="toc-link" href="#computing-gradient"><span class="toc-number">2.</span> <span class="toc-text">Computing gradient</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#numerical-gradient"><span class="toc-number">2.0.0.1.</span> <span class="toc-text">Numerical gradient</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#analytic-gradient"><span class="toc-number">2.0.0.2.</span> <span class="toc-text">Analytic gradient</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gradient-descent"><span class="toc-number">3.</span> <span class="toc-text">Gradient descent</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#summary"><span class="toc-number">4.</span> <span class="toc-text">Summary</span></a></li></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-optimization" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">optimization</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2018/10/05/optimization/" class="article-date"><time datetime="2018-10-05T12:44:14.537Z" itemprop="datePublished">2018-10-05</time></a></span> <span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/cs231n/">cs231n</a></span> <span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link" href="/tags/image-classification/">image classification</a>, <a class="article-tag-link" href="/tags/notebook/">notebook</a></span> <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2018/10/05/optimization/#comments" class="article-comment-link">è¯„è®º</a></span></div></div><div class="article-entry markdown-body" itemprop="articleBody"><h1 id="optimization"><a class="markdownIt-Anchor" href="#optimization"></a> Optimization</h1><ul><li>Optimization is the process of finding the set of parameters W that minimize the loss function,å¦‚ä½•æ”¹å˜wä½¿å¾—æŸå¤±å‡½æ•°ä¸æ–­å‡å°</li></ul><h4 id="strategy-1-random-search"><a class="markdownIt-Anchor" href="#strategy-1-random-search"></a> Strategy #1 random search</h4><ul><li>æ ¸å¿ƒæ€æƒ³:ä¸€æ¬¡æ€§æ‰¾åˆ°ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°çš„wå–å€¼è²Œä¼¼å¾ˆéš¾ï¼Ÿ(random search,a bad ideaï¼‰ï¼Œä½†æ˜¯iterative refinementç›´è§‚ä¸Šæ˜¯å¯è¡Œçš„ï¼Œæ•…å¯ä»¥ç»™äºˆwä¸€ä¸ªrandom å€¼ï¼Œç„¶åè¿­ä»£çš„æ”¹è¿›ï¼Œä½¿å¾—lossæ¯æ¬¡éƒ½æ¯”ä¸Šæ¬¡è¦å°ã€‚Our strategy will be to start with random weights and iteratively refine them over time to get lower loss</li><li>ç±»ä¼¼äºä¸€ä¸ªæˆ´çœ¼ç½©çš„hikerï¼Œåœ¨å¤šä¸ªè§’åº¦ä¸‹å°è¯•å¾€ä¸‹èµ°ï¼Œç›´åˆ°å±±åº•ã€‚å¦‚åœ¨CIFAR-10ä¸­ï¼Œhills are 30730 dimensional.</li></ul><h4 id="strategy-2-random-local-search"><a class="markdownIt-Anchor" href="#strategy-2-random-local-search"></a> Strategy #2 random local search</h4><ul><li>ç­–ç•¥ä¸€ç›¸å½“äºéšæ„é€‰å®šæŸæ¡è·¯å¾„å‰è¿›ï¼Œè‹¥æ ¹æ®è¯¥è·¯å¾„ç›´æ¥èµ°åˆ°çš„åœ°æ–¹æ›´ä½ï¼Œåˆ™é€‰æ‹©è¯¥æ–¹å‘æœ€ä¼˜ï¼›è€Œç­–ç•¥äºŒç›¸å½“äºå…ˆéšæ„é€‰å®šæŸæ¡è·¯å¾„ï¼Œç„¶åå¾ªç¯åœ°åœ¨è¿™ä¸ªè·¯å¾„ä¸Šè¿›è¡Œéšæ„çš„æ–¹å‘ä¿®æ”¹ï¼Œè‹¥èµ°åˆ°çš„åœ°æ–¹æ›´ä½ï¼Œåˆ™è¿›è¡Œè·¯å¾„çš„ä¿®æ”¹ï¼Œç›´åˆ°å¾ªç¯ç»“æŸã€‚</li></ul><h4 id="strategy-3-follow-gradient"><a class="markdownIt-Anchor" href="#strategy-3-follow-gradient"></a> Strategy #3 follow gradient</h4><ul><li>ä¸ç”¨åˆ»æ„è§„åˆ’è·¯çº¿ï¼Œè€Œæ˜¯è¦æ‰¾åˆ°æ¯ä¸€æ­¥çš„æœ€ä¼˜æ–¹å‘ï¼Œå³lossä¸‹é™çš„æ–¹å‘gradinetï¼Œä¹Ÿå°±æ˜¯å½“æ—¶è„šä¸‹çš„hillsçš„æ–œå¡æ–¹å‘</li><li>æ‰€è°“gradientå°±æ˜¯a generalization of slope for functions that donâ€™t take a single number but a vector of numbersï¼Œç”±åœ¨æ‰€æ±‚å‡½æ•°å¯¹æ•´ä¸ªè¾“å…¥ç©ºé—´ä¸­çš„å„ä¸ªç»´åº¦çš„derivativeï¼Œå³åå¯¼æ•°ç»„æˆã€‚ä¸€ç»´å¯¼æ•°çš„å®šä¹‰:</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>d</mi><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mo>=</mo><msub><mi>lim</mi><mrow><mi>h</mi><mtext></mtext><mo>â†’</mo><mn>0</mn></mrow></msub><mfrac><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>h</mi><mo>)</mo><mo>âˆ’</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo></mrow><mrow><mi>h</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{df(x)}{dx} = \lim_{h\ \to 0} \frac{f(x + h) - f(x)}{h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em"></span><span class="strut bottom" style="height:2.179108em;vertical-align:-.7521079999999999em"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">d</span><span class="mord mathit">x</span></span></span></span><span style="top:-.22999999999999998em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:.6521079999999999em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">h</span><span class="mord mspace">Â </span><span class="mrel">â†’</span><span class="mord mathrm">0</span></span></span></span><span style="top:-2.7755575615628914e-17em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span><span class="mop">lim</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">h</span></span></span></span><span style="top:-.22999999999999998em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><ul><li>When the functions of interest take a vector of numbers instead of a single number,(å³è‡ªå˜é‡ä¸æ­¢ä¸€ä¸ª,å¯¹ä¸åŒçš„å˜é‡è¿›è¡Œæ±‚å¯¼) we call the derivatives partial derivatives, and the gradient is simply the vector of partial derivatives in each dimension.</li><li>gradientæ˜¯å‡½æ•°å¢é•¿é€Ÿç‡æœ€å¿«çš„æ–¹å‘,The gradient tells us the slope of the loss function along every dimension, which we can use to make an updateã€‚</li></ul><h1 id="computing-gradient"><a class="markdownIt-Anchor" href="#computing-gradient"></a> Computing gradient</h1><p>ä¸¤ç§æ–¹å¼:æ•°å€¼è§£å’Œåˆ†æè§£</p><h4 id="numerical-gradient"><a class="markdownIt-Anchor" href="#numerical-gradient"></a> Numerical gradient</h4><ul><li>å®è´¨æ˜¯æ ¹æ®ä¸€ç»´å¯¼æ•°çš„å…¬å¼è¿›è¡Œè®¡ç®—ï¼Œæ¯æ¬¡åœ¨è¾“å…¥xçš„ä¸€ä¸ªç»´åº¦ä¸Šè¿›è¡Œæ•°å€¼æ±‚è§£ï¼Œå³è®©è¯¥ç»´åº¦ä¸Šæ—§çš„å€¼åŠ ä¸ŠæŒ‡å®šçš„h(å°½å¯èƒ½å°ï¼Œå…¬å¼ä¸­æ˜¯goes toward zero)ï¼Œç®—å¾—f(x+h)åå†ç®—(f(x+h)-f(x))/hï¼Œä»¥æ±‚å¾—åœ¨è¯¥ç»´åº¦ä¸Šçš„åå¯¼æ•°çš„è¿‘ä¼¼å€¼,è®¡ç®—å®ŒæŸä¸ªç»´åº¦åæ³¨æ„è¦è®¾ç½®å›åŸæ¥çš„è¾“å…¥å†è¿›è¡Œä¸‹ä¸ªç»´åº¦çš„è®¡ç®—.</li><li><code>it = np.nditer(x, flags=['multi_index'], op_flags=['readwrite'])</code>åˆ›å»ºäº†ä¸€ä¸ªnumpyæ•°ç»„çš„è¿­ä»£å™¨ï¼Œè¿™é‡Œçš„flagsè¡¨ç¤ºå¯¹æ•°ç»„è¿›è¡Œå¤šé‡ç´¢å¼•ï¼Œop_flagsè¡¨ç¤ºè¿­ä»£å™¨å¯¹æ•°ç»„xå¯æ‰§è¡Œè¯»å†™æ“ä½œã€‚<code>print it.multi_index</code>å¯ä»¥å¾—åˆ°æ•°ç»„å…ƒç´ æ‰€æœ‰çš„ç´¢å¼•(ä»¥å…ƒç»„å½¢å¼è¿”å›)ï¼Œå¦‚(0,0),(0,1)</li><li>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè®¡ç®—æ¢¯åº¦çš„æ—¶å€™å¸¸ç”¨centered difference formula</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>h</mi><mo>)</mo><mo>âˆ’</mo><mi>f</mi><mo>(</mo><mi>x</mi><mo>âˆ’</mo><mi>h</mi><mo>)</mo></mrow><mrow><mn>2</mn><mi>h</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{f(x+h)-f(x-h)}{2h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em"></span><span class="strut bottom" style="height:2.113em;vertical-align:-.686em"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:.686em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit">h</span></span></span></span><span style="top:-.22999999999999998em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-.677em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">+</span><span class="mord mathit">h</span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mord mathit" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mbin">âˆ’</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><ul><li>æ ¹æ®gradientï¼Œåœ¨æ¯ä¸ªç»´åº¦ä¸Šæœç€loss funcitnå¢é•¿é€Ÿç‡æœ€å¿«çš„æ–¹å‘çš„è´Ÿæ–¹å‘è¿›è¡Œstep_sizeçš„æ›´æ–°ã€‚Update in negative gradient direction. In the code above, notice that to compute W_new we are making an update in the negative direction of the gradient df since we wish our loss function to decrease, not increase.</li><li>step_sizeçš„ä½œç”¨:the gradient tells us the direction in which the function has the steepest rate of increase, but it does not tell us how far along this direction we should step</li><li>æ•ˆç‡é—®é¢˜:æ˜¾ç„¶å¯¹äºæ¯ä¸ªç»´åº¦(æ•°ç»„ç´¢å¼•)è¿›è¡Œæ•°å€¼æ±‚è§£ï¼Œåˆ™å¯¹äºgradientçš„æ±‚è§£æ˜¯O(n)ï¼Œnä¸ºwçš„ç»´åº¦ï¼Œæˆ–è€…<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="strut bottom" style="height:.716668em;vertical-align:-.286108em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:-.02691em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:.05724em">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span>çš„ä¸ªæ•°ï¼›å¯¹äºç¥ç»ç½‘ç»œè€Œè¨€ï¼Œå‚æ•°ä¸ªæ•°å¤ªå¤šï¼Œæ•°å€¼è§£æ‰©å±•æ€§å¤ªå·®ã€‚</li></ul><h4 id="analytic-gradient"><a class="markdownIt-Anchor" href="#analytic-gradient"></a> Analytic gradient</h4><p>é€šè¿‡å¾®ç§¯åˆ†è¿›è¡Œå¯¼æ•°çš„æ¨å¯¼,å¾—åˆ°å¯¼æ•°ç¡®åˆ‡çš„å€¼ï¼Œè€Œä¸æ˜¯è¿‘ä¼¼è§£ã€‚</p><ul><li>æ±‚å¯¼æ•°å®¹æ˜“å‡ºé”™ï¼Œæ‰€ä»¥ç»å¸¸è®²åˆ†æè§£å’Œæ•°å€¼è§£è¿›è¡Œæ¯”è¾ƒï¼Œç§°ä¸ºgradient checkã€‚</li><li>ä¸¾ä¾‹SVM loss functionï¼Œå¯¹äºå•ä¸ªç¤ºä¾‹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="strut bottom" style="height:.58056em;vertical-align:-.15em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span>:</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>j</mi><mo>â‰ </mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mrow><mo fence="true">[</mo><mi>max</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><msubsup><mi>w</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msubsup><mi>w</mi><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi mathvariant="normal">Î”</mi><mo>)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">L_i = \sum_{j\neq y_i} \left[ \max(0, w_j^Tx_i - w_{y_i}^Tx_i + \Delta) \right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em"></span><span class="strut bottom" style="height:2.51771em;vertical-align:-1.467705em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.2172049999999999em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:.05724em">j</span><span class="mrel">â‰ </span><span class="mord"><span class="mord mathit" style="margin-right:.03588em">y</span><span class="vlist"><span style="top:.15em;margin-right:.07142857142857144em;margin-left:-.03588em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-.000005000000000032756em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0"><span class="delimsizing size1">[</span></span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.24700000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:.05724em">j</span></span></span><span style="top:-.41300000000000003em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:.13889em">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.24700000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:.03588em">y</span><span class="vlist"><span style="top:.15em;margin-right:.07142857142857144em;margin-left:-.03588em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-.41300000000000003em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:.13889em">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathrm">Î”</span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><ul><li>å¯¹äº<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">w_{y_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="strut bottom" style="height:.716668em;vertical-align:-.286108em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:-.02691em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:.03588em">y</span><span class="vlist"><span style="top:.15em;margin-right:.07142857142857144em;margin-left:-.03588em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span>,</li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msub><mi>w</mi><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow></msub></mrow></msub><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mo>âˆ’</mo><mrow><mo fence="true">(</mo><msub><mo>âˆ‘</mo><mrow><mi>j</mi><mo>â‰ </mo><msub><mi>y</mi><mi>i</mi></msub></mrow></msub><mrow><mn mathvariant="normal">1</mn></mrow><mo>(</mo><msubsup><mi>w</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msubsup><mi>w</mi><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi mathvariant="normal">Î”</mi><mo>&gt;</mo><mn>0</mn><mo>)</mo><mo fence="true">)</mo></mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\nabla_{w_{y_i}} L_i = - \left( \sum_{j\neq y_i} \mathbb{1}(w_j^Tx_i - w_{y_i}^Tx_i + \Delta &gt; 0) \right) x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05002em"></span><span class="strut bottom" style="height:3.60004em;vertical-align:-1.55002em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:.14999999999999997em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.15000000000000002em;margin-right:.07142857142857144em;margin-left:-.02691em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:.03588em">y</span><span class="vlist"><span style="top:.31472em;margin-right:.1em;margin-left:-.03588em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord">âˆ’</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.9049999999999999em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="delimsizinginner delim-size4"><span>â›</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.2172049999999999em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:.05724em">j</span><span class="mrel">â‰ </span><span class="mord"><span class="mord mathit" style="margin-right:.03588em">y</span><span class="vlist"><span style="top:.15em;margin-right:.07142857142857144em;margin-left:-.03588em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-.000005000000000032756em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">1</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.24700000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:.05724em">j</span></span></span><span style="top:-.41300000000000003em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:.13889em">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.24700000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:.03588em">y</span><span class="vlist"><span style="top:.15em;margin-right:.07142857142857144em;margin-left:-.03588em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-.41300000000000003em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:.13889em">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathrm">Î”</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:.9049999999999999em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="delimsizinginner delim-size4"><span>â </span></span></span><span style="top:-.89502em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="delimsizinginner delim-size4"><span>â</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><p>where ğŸ™ is the indicator function that is one if the condition inside is true or zero otherwise<br>å¯¹äº<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">w_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.43056em"></span><span class="strut bottom" style="height:.716668em;vertical-align:-.286108em"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:-.02691em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span>,</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">âˆ‡</mi><mrow><msub><mi>w</mi><mi>j</mi></msub></mrow></msub><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mrow><mn mathvariant="normal">1</mn></mrow><mo>(</mo><msubsup><mi>w</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>âˆ’</mo><msubsup><mi>w</mi><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><mi>T</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi mathvariant="normal">Î”</mi><mo>&gt;</mo><mn>0</mn><mo>)</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\nabla_{w_j} L_i = \mathbb{1}(w_j^Tx_i - w_{y_i}^Tx_i + \Delta &gt; 0) x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:.891331em"></span><span class="strut bottom" style="height:1.274439em;vertical-align:-.383108em"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathrm">âˆ‡</span><span class="vlist"><span style="top:.14999999999999997em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.15000000000000002em;margin-right:.07142857142857144em;margin-left:-.02691em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit" style="margin-right:.05724em">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">L</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">1</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.24700000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:.05724em">j</span></span></span><span style="top:-.41300000000000003em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:.13889em">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mbin">âˆ’</span><span class="mord"><span class="mord mathit" style="margin-right:.02691em">w</span><span class="vlist"><span style="top:.24700000000000003em;margin-left:-.02691em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:.03588em">y</span><span class="vlist"><span style="top:.15em;margin-right:.07142857142857144em;margin-left:-.03588em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-.41300000000000003em;margin-right:.05em"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:.13889em">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathrm">Î”</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:.15em;margin-right:.05em;margin-left:0"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0">â€‹</span></span>â€‹</span></span></span></span></span></span></span></p><ul><li>Once you derive the expression for the gradient it is straight-forward to implement the expressions and use them to perform the gradient update</li></ul><h1 id="gradient-descent"><a class="markdownIt-Anchor" href="#gradient-descent"></a> Gradient descent</h1><ul><li>the procedure of repeatedly evaluating the gradient and then performing a parameter update is called Gradient Descent</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while True:</span><br><span class="line">  weights_grad = evaluate_gradient(loss_fun, data, weights)</span><br><span class="line">  weights += - step_size * weights_grad # perform parameter update</span><br></pre></td></tr></table></figure><ul><li>Mini-batch gradient descent.å¯¹äºè¾“å…¥æ•°æ®é‡åºå¤§çš„training setï¼Œä¸ºäº†æ›´æ–°wçš„æŸä¸ªç´¢å¼•ä¸‹çš„å€¼è€Œå¯¹åºå¤§çš„dataè¿›è¡Œæ“ä½œæœ‰ç‚¹æµªè´¹ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯compute the gradient over batches of the training data</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while True:</span><br><span class="line">  data_batch = sample_training_data(data, 256) # sample 256 examples</span><br><span class="line">  weights_grad = evaluate_gradient(loss_fun, data_batch, weights)</span><br><span class="line">  weights += - step_size * weights_grad # perform parameter update</span><br></pre></td></tr></table></figure><ul><li>ä¸ºä½•åœ¨ä¸€å°éƒ¨åˆ†çš„æ•°æ®ä¸­æ›´æ–°wä¹Ÿæ˜¯å¯è¡Œçš„ï¼ŸThe reason this works well is that the examples in the training data are correlated</li><li>The extreme case of this is a setting where the mini-batch contains only a single example. This process is called Stochastic Gradient Descent (SGD) (or also sometimes on-line gradient descent)æ¯”è¾ƒå°‘è§</li></ul><h1 id="summary"><a class="markdownIt-Anchor" href="#summary"></a> Summary</h1><p><img src="/images/181005/dataflow.jpeg" alt=""></p><ul><li>ä¸¤ç§æ±‚gradientçš„æ–¹æ³•:We discussed the tradeoffs between computing the numerical and analytic gradient. The numerical gradient is simple but it is approximate and expensive to compute. The analytic gradient is exact, fast to compute but more error-prone since it requires the derivation of the gradient with math. Hence, in practice we always use the analytic gradient and then perform a gradient check, in which its implementation is compared to the numerical gradient</li><li>æ¢¯åº¦ä¸‹é™æ–¹æ³•:We introduced the Gradient Descent algorithm which iteratively computes the gradient and performs a parameter update in loop</li><li>æ€»çš„æ¥è¯´ä¼˜åŒ–å°±æ˜¯é€šè¿‡å¯»æ‰¾loss functionä¸‹é™é€Ÿåº¦æœ€å¿«çš„æ–¹å‘(gradientçš„åæ–¹å‘)ï¼Œå¯¹wè¿›è¡Œä¸æ–­çš„é€‚å½“å¹…åº¦(learning rate)çš„æ›´æ–°ï¼Œä½¿å¾—lossä¸æ–­å‡å°‘ã€‚</li></ul></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="http://aier02.com/2018/10/05/optimization/" title="optimization" target="_blank" rel="external">http://aier02.com/2018/10/05/optimization/</a></li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://github.com/aier02" target="_blank" class="img-burn thumb-sm visible-lg"><img src="/images/avatar.jpg" class="img-rounded w-full" alt=""></a></div><div class="media-body"><h3 class="media-heading"><a href="https://github.com/aier02" target="_blank"><span class="text-dark">Amadeus</span><small class="ml-1x">cvçˆ±å¥½è€…</small></a></h3><div>ä¸ªäººç®€ä»‹ã€‚</div></div></figure></div></div></div></article><section id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zODYxOC8xNTE0Ng=="><noscript>ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="next"><a href="/2018/10/03/linear_classification/" title="Linear classification"><span>ä¸‹ä¸€ç¯‡&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="æ–‡ç« ç›®å½•" role="button"><span>[&nbsp;</span><span>æ–‡ç« ç›®å½•</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div></div></div></nav></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/aier02" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright"><div class="publishby">Theme by <a href="https://github.com/cofess" target="_blank">cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.</div></div></footer><script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>!function(T){var N={TRANSLATION:{POSTS:"æ–‡ç« ",PAGES:"é¡µé¢",CATEGORIES:"åˆ†ç±»",TAGS:"æ ‡ç­¾",UNTITLED:"(æœªå‘½å)"},ROOT_URL:"/",CONTENT_URL:"/content.json"};T.INSIGHT_CONFIG=N}(window)</script><script src="/js/insight.js"></script><script defer type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&(n=e.createElement(t),n.src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script></body></html><!-- rebuild by neat -->